{% load static %}
<div id="main" class="chat">
    {% if broadcaster_status.Status == "Pending_Broadcaster"%}
    <div ts="n4" id="VideoPanel" style="height: auto; width: 59%; position: relative; overflow: visible; -webkit-tap-highlight-color: transparent;background-color:transparent; display: inline-block; border-radius: 2px; box-sizing: border-box; font-family: UbuntuRegular, Helvetica, Arial, sans-serif; font-size: 11px;border:none;">
        <h1> We are still looking though your Information</h1>
        <p>Please give us at lease 48 hours to make sure your informatino is currect</p>
    </div>

    {% endif %}

    {% if user_status == "Broadcaster" %}

    <div class="chat_room" style="font: 1em UbuntuRegular, Arial, Helvetica, sans-serif;">
        <div class="topSectionWrapper" style="width: 75%; height: auto; display: block;">
            <div ts="n4" id="VideoPanel" style="height: auto; width: 100%; position: relative; overflow: visible; -webkit-tap-highlight-color: transparent; display: inline-block; border-radius: 6px; box-sizing: border-box; font-family: UbuntuRegular, Helvetica, Arial, sans-serif; font-size: 11px;background-color:#6cc6ba;border:2px solid black;padding:2px;">

                <div style="display: block;">
                    <div class="roomSubject defaultColor" data-testid="room-subject">
                        <span class="RoomSubjectSpan">
                            <span>explosion :
                                
                                {% if room_data.Goal == 0 %}
                                    No goal has been set
                                {% else %}

                                {{room_sesson.Goal_Currrent}} / {{room_data.Goal}}

                                {% endif %}
                            </span>
                        </span>
                    </div>
                    <div class="roomSubjectTooltip roomSubjectToolTipColor" data-testid="room-subject-tooltip" style="width: 500px; visibility: hidden;">Goal reached!</div>
                </div>
                <div ts="j0" id="TheaterModePlayer" data-listener-count-fullscreenchange="1" style="height: 322.312px; width: 100%; position: relative; overflow: hidden; -webkit-tap-highlight-color: transparent; background-color: rgb(0, 0, 0);">
                    <div ts="EQ" class="videoPlayerDiv" style="height: 100%; width: 100%; position: relative; overflow: hidden; -webkit-tap-highlight-color: transparent; background: url({% static './images/bg/cam_notice_bg.jpg' %}) center center / cover rgb(51, 51, 51); left: 0px;">
                        <input style="display:none; border:none; background-color:crimson; box-shadow: 1px 2px 5px rgba(0,0,0,.15);" class="realButtons" id="startStreaming_button" type="submit" value="Start Making Vibez" onclick="if_not_Streamer()"/>
                        
                        {% include "rooms/include/videoPlayerDiv.html" %}
                    </div>
                </div>

            </div>

            <div ts="Zv" data-listener-count-mousedown="1" data-listener-count-touchmove="1" class="resizeHandle" style="height: 425.312px; position: absolute; overflow: hidden; -webkit-tap-highlight-color: transparent; display: inline-block; box-sizing: border-box; cursor: ew-resize;"></div>

            
            <div ts="x_" class="BaseTabsContainer m-2" id="ChatTabContainer" style="height: 445px; width: 25%; position: absolute; -webkit-tap-highlight-color: transparent; display:inline-block; font-family: UbuntuRegular, Helvetica, Arial, sans-serif; border-radius: 6px;  box-sizing: border-box;border:2px solid black;background-color:#6cc6ba;color:#black;margin-left:20px;">


                <div class="tab-pane fade show active" id="nav-stats" role="tabpanel" aria-labelledby="nav-stats-tab">

                    <div class="msg-list-wrapper-split" data-listener-count-scroll="1" style="box-sizing: border-box; overflow: auto; margin: 0px auto 5px; padding: 5px; height: 365px; line-height: 16pt;">

                        <div class="notice-list-fvm" style="width: 100%; user-select: text; cursor: text;">

                        </div>

                        <ul class="nav nav-pills mb-3 d-flex flex-row gap-2" id="pills-tab" role="tablist">
                            <li class="nav-item">

                            </li>
                            <li class="nav-item">

                            </li>
                            <li class="nav-item">

                            </li>

                          </ul>


                          <div class="tab-content" id="pills-tabContent">


                            {% comment %} Chat {% endcomment %}
                            <ul class="nav nav-pills mb-3 d-flex flex-row gap-2" id="pills-tab" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="pills-chat-tab" data-toggle="pill" href="#pills-chat" role="tab" aria-controls="pills-chat" aria-selected="true">Chat</a>
                                  </li>
                            
                            </ul>

                            <div class="tab-content" id="pills-tabContent">
                                <div class="tab-pane  show active" id="pills-chat" role="tabpanel" aria-labelledby="pills-chat-tab">
                                    {% include "rooms/include/broadcaster_chat.html" %}     
                                </div>
                            </div>

                          </div>

                                
                    </div>
                </div>
            </div>

</div>


        </div>
    </div>



    
    {% endif %}


            <div ts="x_" class="BaseTabsContainer m-2" id="ChatTabContainer" style="height: 445px; width: 100%; position: relative; -webkit-tap-highlight-color: transparent; display:inline-block; font-family: UbuntuRegular, Helvetica, Arial, sans-serif; border-radius: 6px;  box-sizing: border-box;border:2px solid black;background-color:#6cc6ba;color:#black;margin-left:20px;">


                <div class="tab-pane fade show active" id="nav-stats" role="tabpanel" aria-labelledby="nav-stats-tab">

                    <div class="msg-list-wrapper-split" data-listener-count-scroll="1" style="box-sizing: border-box; overflow: auto; margin: 0px auto 5px; padding: 5px; height: 365px; line-height: 16pt;">

                        <div class="notice-list-fvm" style="width: 100%; user-select: text; cursor: text;">

                        </div>

                        <ul class="nav nav-pills mb-3 d-flex flex-row gap-2" id="pills-tab" role="tablist">
                            <li class="nav-item">
                              <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">Room Stats</a>
                            </li>
                            <li class="nav-item">
                              <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false">Slot Machine</a>
                            </li>
                            <li class="nav-item">
                              <a class="nav-link" id="pills-lovense-toy-tab" data-toggle="pill" href="#pills-lovense-toy" role="tab" aria-controls="pills-lovense" aria-selected="false">Connect Lovense Toy</a>
                            </li>


                            <li class="nav-item">
                                <a class="nav-link" id="pills-settings-privacy-tab" data-toggle="pill" href="#pills-settings-privacy" role="tab" aria-controls="pills-settings-privacy" aria-selected="false">Settings and Privacy</a>
                              </li>
         
                          </ul>
                          <div class="tab-content" id="pills-tabContent">


                            <div class="tab-pane  show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                                {% include 'rooms/include/room_stats.html' %}
                            </div>

                            <div class="tab-pane fade" id="pills-lovense-toy" role="tabpanel" aria-labelledby="pills-lovense-toy">
                                <img class="" id="lovense_qr_code_img">
                             

                                <button class="btn btn-primary w-25" onclick="generate_lovense_qrcode()" id="lovense_qrcode_btn">Generate Qr Code</button>
                            </div>


                            <div class="tab-pane fade" id="pills-settings-privacy" role="tabpanel" aria-labelledby="pills-settings-privacy">
                             
                                Settings
                            </div>

                            <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">

                                <div class="container-fluid">
                                    <div class="row">
                                        <form id="set_slot_machine" method="POST" action="{% url 'set_slot_machine' %}" class="col-8 gap-2">
                                            {% csrf_token %}

                                           
                                            
                                            <label for="set_vibez_per_spin">Set vibez per spin</label>
                                            <input type="number" value="
                                            {% if slot_machine_data %}
                                            {{slot_machine_data.Slot_cost_per_spin}}
                                                    {% endif %}
                                            " class="form-control" id="set_vibez_per_spin" name="Slot_cost_per_spin">

                                            <input type="number" class="form-control d-none" id="" value="
                                            {% if slot_machine_data %}
                                            {{room_data.User.id}}
                                            {% endif %}
                                            " name="User">
                                            
                                            <label for="set_3_of_a_kind_prize">Set prize for 3 of a kind win</label>
                                            <input type="text" value="
                                            {% if slot_machine_data %}
                                            {{slot_machine_data.Win_3_of_a_kind_prize}}
                                            {% endif %}
                                            " class="form-control" id="set_3_of_a_kind_prize" name="Win_3_of_a_kind_prize">
                                            
                                            <label for="set_2_of_a_kind_prize">Set prize for 2 of a kind win</label>
                                            <input type="text" value="
                                            {% if slot_machine_data %}
                                            {{slot_machine_data.Win_2_of_a_kind_prize}}
                                            {% endif %}
                                            " class="form-control" id="set_2_of_a_kind_prize" name="Win_2_of_a_kind_prize">
                               


                                            <button type="submit" class="btn btn-primary my-2">Set</button>
                                        
                                        </form>
                                    </div>
                                </div>
                            </div>

                          </div>

                                
                    </div>
                </div>
            </div>

</div>
<div ts="Zv" data-listener-count-mousedown="1" data-listener-count-touchmove="1" class="resizeHandle" style="height: 425.312px; width: 8px; position: absolute; overflow: hidden; -webkit-tap-highlight-color: transparent; display: inline-block; box-sizing: border-box; cursor: ew-resize;"></div>

<link rel="stylesheet" href="{% static 'css/multi.css' %}">
<script type="text/javascript" src="{% static 'js/multi.js' %}"></script>

<script>

    var block_countries = document.getElementById('block_countries');
    var select = document.getElementById('select_countries');

    const choices = new Choices(select, {
        removeItemButton: true, 
    });


    block_countries.onsubmit = (event) => {
        event.preventDefault();
        
        const formData = new FormData(block_countries);
        formData.append('broadcaster', room_data.id);
        formData.append('csrfmiddlewaretoken', "{{ csrf_token }}");

        $.ajax({
            method:'POST',
            url: "room/block_countries/",
            contentType: false,  // Set this to false to let jQuery handle the content type automatically
            processData: false, 
                success:function(){
                    document.getElementById('save_blocked_countries').style.display = 'block'
                },
            error: function(errors) {
                    console.log(errors.responseText);
                  },
        });

    }



    function generate_lovense_qrcode(){
        $.ajax({
            method:'POST',
            url: "lovense/generate_broadcaster_qrcode/",
            data: {
                'csrfmiddlewaretoken':"{{csrf_token}}",
            },
            success:function(data)
            {
                console.log(data.data.qr)
                const qrCodeImg = document.getElementById('lovense_qr_code_img');
                qrCodeImg.src = data.data.qr;
                qrCodeImg.style.display = 'block'; //
            },
            errors:function(errors){
                console.log(errors.responseText)
            }
        })
    }





</script>